<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15 C√¢u Sinh T·ª≠ - Pro Version</title>
    <style>
        body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #020230; color: #fff; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .box { width: 95%; max-width: 480px; background: #000; border: 3px solid gold; border-radius: 16px; padding: 25px; box-shadow: 0 0 20px rgba(255, 215, 0, 0.2); }
        h1, h2 { text-align: center; color: gold; margin-top: 0; }
        .btn { width: 100%; padding: 12px; margin-top: 10px; border-radius: 10px; border: 2px solid gold; background: #000; color: #fff; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn:hover { background: gold; color: #000; }
        .option { border: 1px solid #0984e3; padding: 12px; border-radius: 8px; margin-top: 10px; cursor: pointer; transition: all 0.2s; background: rgba(255,255,255,0.05); }
        .option:hover { background: rgba(9, 132, 227, 0.2); border-color: #fff; }
        .correct { background: #27ae60 !important; border-color: #2ecc71 !important; color: white; }
        .wrong { background: #e74c3c !important; border-color: #ff7675 !important; color: white; }
        .hidden { display: none; }
        #explain { color: #f1c40f; margin-top: 15px; padding: 10px; border-left: 3px solid gold; background: rgba(241, 196, 15, 0.1); font-style: italic; }
        small { opacity: .6; display: block; text-align: center; margin-top: 15px; }
        .disabled { pointer-events: none; }
    </style>
</head>
<body>

<div class="box">
    <div id="screen-start">
        <h1>üß† 15 C√ÇU SINH T·ª¨</h1>
        <p style="text-align: center;">V∆∞·ª£t qua 15 c√¢u h·ªèi h√≥c b√∫a ƒë·ªÉ tr·ªü th√†nh Huy·ªÅn Tho·∫°i.</p>
        <button class="btn" onclick="startGame()">B·∫ÆT ƒê·∫¶U</button>
        <button class="btn" style="border-color: #555; font-size: 0.8em;" onclick="resetProgress()">X√ìA L·ªäCH S·ª¨ C√ÇU H·ªéI</button>
    </div>

    <div id="screen-play" class="hidden">
        <h2 id="progress"></h2>
        <p id="question" style="font-size: 1.1em; min-height: 50px;"></p>
        <div id="options"></div>
        <div id="explain" class="hidden"></div>
        <button id="stopBtn" class="btn hidden" onclick="stopGame()" style="margin-top: 20px; border-color: #e67e22;">‚èπÔ∏è D·ª™NG CU·ªòC CH∆†I</button>
    </div>

    <div id="screen-result" class="hidden">
        <h1 id="resultTitle"></h1>
        <p id="resultMsg" style="text-align: center; font-size: 1.2em;"></p>
        <button class="btn" onclick="location.reload()">CH∆†I L·∫†I</button>
        <small>Game gi·∫£i tr√≠ nh·ªè c·ªßa NCT - Phi√™n b·∫£n N√¢ng c·∫•p</small>
    </div>
</div>

<script>
/* ================== DATA ================== */
const QUESTIONS = [
    {id:1,level:"easy",q:"Th√°ng n√†o c√≥ 28 ng√†y?",o:["Th√°ng 2","T·∫•t c·∫£ c√°c th√°ng","Th√°ng nhu·∫≠n","Kh√¥ng c√≥"],c:[1]},
    {id:2,level:"easy",q:"1 + 1 = ?",o:["1","2","3","4"],c:[1]},
    {id:3,level:"easy",q:"M·∫∑t tr·ªùi m·ªçc h∆∞·ªõng n√†o?",o:["T√¢y","ƒê√¥ng","Nam","B·∫Øc"],c:[1]},
    {id:4,level:"easy",q:"Con g√¨ k√™u g√¢u g√¢u?",o:["M√®o","Ch√≥","G√†","B√≤"],c:[1]},
    {id:5,level:"easy",q:"Vi·ªát Nam ·ªü ch√¢u n√†o?",o:["√Å","√Çu","Phi","M·ªπ"],c:[0]},
    {id:20,level:"medium",q:"C√≥ c√¥ng m√†i ___ c√≥ ng√†y n√™n kim",o:["dao","s·∫Øt","b√∫a","ki·∫øm"],c:[1]},
    {id:21,level:"medium",q:"S·ªë nguy√™n t·ªë nh·ªè nh·∫•t?",o:["1","2","3","0"],c:[1]},
    {id:22,level:"medium",q:"HTML d√πng ƒë·ªÉ?",o:["Style","Logic","C·∫•u tr√∫c web","Server"],c:[2]},
    {id:23,level:"medium",q:"ƒê∆°n v·ªã ƒëo ƒëi·ªán √°p?",o:["A","V","W","Hz"],c:[1]},
    {id:24,level:"medium",q:"Tr√°i ƒë·∫•t quay quanh?",o:["M·∫∑t trƒÉng","Sao H·ªèa","M·∫∑t tr·ªùi","Sao Kim"],c:[2]},
    {id:40,level:"hard",q:"S·ªë n√†o v·ª´a l√† ch√≠nh ph∆∞∆°ng v·ª´a l√† l·∫≠p ph∆∞∆°ng?",o:["16","36","64","81"],c:[2],explain:"64 = 8¬≤ v√† c≈©ng = 4¬≥"},
    {id:41,level:"hard",q:"Th·ª© g√¨ c√†ng l·∫•y ƒëi c√†ng l·ªõn?",o:["Ti·ªÅn","C√°i h·ªë","Th·ªùi gian","N·ª£"],c:[1],explain:"Khi b·∫°n l·∫•y ƒë·∫•t ƒëi, c√°i h·ªë s·∫Ω to ra."},
    {id:42,level:"hard",q:"H√†nh tinh n√†o sau ƒë√¢y KH√îNG c√≥ m·∫∑t trƒÉng?",o:["Sao Kim","Tr√°i ƒê·∫•t","Sao H·ªèa","Sao M·ªôc"],c:[0],explain:"Sao Kim v√† Sao Th·ªßy kh√¥ng c√≥ v·ªá tinh t·ª± nhi√™n."},
    {id:43,level:"hard",q:"Hi·ªán t∆∞·ª£ng n√†o khi·∫øn b·∫ßu tr·ªùi c√≥ m√†u xanh?",o:["Ph·∫£n chi·∫øu ƒë·∫°i d∆∞∆°ng","T√°n x·∫° Rayleigh","Hi·ªáu ·ª©ng nh√† k√≠nh","Kh√∫c x·∫° n∆∞·ªõc"],c:[1],explain:"C√°c b∆∞·ªõc s√≥ng ng·∫Øn (xanh) b·ªã t√°n x·∫° m·∫°nh h∆°n b·ªüi kh√≠ quy·ªÉn."},
    {id:44,level:"hard",q:"C√¢u n√≥i n√†o t·∫°o ra ngh·ªãch l√Ω t·ª± th√¢n?",o:["T√¥i ƒëang n√≥i d·ªëi","2 + 2 = 5","M·∫∑t tr·ªùi m·ªçc h∆∞·ªõng T√¢y","Con g√† c√≥ tr∆∞·ªõc qu·∫£ tr·ª©ng"],c:[0],explain:"N·∫øu c√¢u 'T√¥i ƒëang n√≥i d·ªëi' l√† ƒë√∫ng, th√¨ ng∆∞·ªùi ƒë√≥ ƒëang n√≥i th·∫≠t, d·∫´n ƒë·∫øn m√¢u thu·∫´n."}
];

/* ================== LOGIC ================== */
const LOCK_KEY="LOCKED_IDS";
let locked=JSON.parse(localStorage.getItem(LOCK_KEY)||"[]");
let pack=[], index=0;

const startScr=document.getElementById("screen-start"),
      playScr=document.getElementById("screen-play"),
      resultScr=document.getElementById("screen-result"),
      progress=document.getElementById("progress"),
      question=document.getElementById("question"),
      options=document.getElementById("options"),
      explainBox=document.getElementById("explain"),
      stopBtn=document.getElementById("stopBtn"),
      resultTitle=document.getElementById("resultTitle"),
      resultMsg=document.getElementById("resultMsg");

function buildPack(){
    const pick=(lvl,n) => {
        let pool = QUESTIONS.filter(q => q.level === lvl && !locked.includes(q.id));
        if(pool.length < n) pool = QUESTIONS.filter(q => q.level === lvl); // Reset pool n·∫øu h·∫øt c√¢u h·ªèi
        return pool.sort(() => Math.random() - 0.5).slice(0, n);
    };
    return [...pick("easy",5), ...pick("medium",5), ...pick("hard",5)];
}

function startGame(){
    pack = buildPack();
    index = 0;
    show(playScr);
    loadQ();
}

function loadQ(){
    const q = pack[index];
    progress.innerText = `C√¢u ${index+1}/15`;
    question.innerText = q.q;
    options.innerHTML = "";
    explainBox.classList.add("hidden");
    
    q.o.forEach((text, i) => {
        const d = document.createElement("div");
        d.className = "option";
        d.innerText = text;
        d.onclick = () => checkAnswer(i);
        options.appendChild(d);
    });
    
    // Ch·ªâ hi·ªán n√∫t D·ª´ng t·ª´ c√¢u 10 tr·ªü ƒëi (M·ªëc quan tr·ªçng)
    stopBtn.classList.toggle("hidden", index < 9);
}

function checkAnswer(userChoice){
    const q = pack[index];
    const allOptions = document.querySelectorAll(".option");
    
    // V√¥ hi·ªáu h√≥a click ƒë·ªÉ tr√°nh b·∫•m nhi·ªÅu l·∫ßn
    options.classList.add("disabled");

    if(q.c.includes(userChoice)){
        // TR·∫¢ L·ªúI ƒê√öNG
        allOptions[userChoice].classList.add("correct");
        
        setTimeout(() => {
            index++;
            if(index === 15){
                lockTouched(true);
                win();
            } else {
                options.classList.remove("disabled");
                loadQ();
            }
        }, 800);
    } else {
        // TR·∫¢ L·ªúI SAI
        allOptions[userChoice].classList.add("wrong");
        // Hi·ªÉn th·ªã ƒë√°p √°n ƒë√∫ng cho ng∆∞·ªùi ch∆°i th·∫•y
        q.c.forEach(correctIdx => allOptions[correctIdx].classList.add("correct"));
        
        explainBox.innerText = q.explain || "B·∫°n ƒë√£ ch·ªçn sai m·∫•t r·ªìi!";
        explainBox.classList.remove("hidden");
        
        setTimeout(() => {
            lockTouched();
            lose();
        }, 2000);
    }
}

function lockTouched(isWin = false){
    const touched = isWin ? pack : pack.slice(0, index + 1);
    touched.forEach(q => { if(!locked.includes(q.id)) locked.push(q.id); });
    localStorage.setItem(LOCK_KEY, JSON.stringify(locked));
}

function stopGame(){
    resultTitle.innerText = "‚èπÔ∏è D·ª™NG CU·ªòC CH∆†I";
    resultMsg.innerText = `Quy·∫øt ƒë·ªãnh an to√†n! B·∫°n d·ª´ng ·ªü c√¢u ${index+1} v·ªõi s·ªë ƒëi·ªÉm danh d·ª±.`;
    show(resultScr);
}

function lose(){
    resultTitle.innerText = "üíÄ THUA CU·ªòC";
    resultMsg.innerText = index < 5 ? "B·∫°n c·∫ßn h·ªçc th√™m ch√∫t n·ªØa r·ªìi... üòÖ" : `B·∫°n ƒë√£ d·ª´ng b∆∞·ªõc ·ªü c√¢u s·ªë ${index+1}.`;
    show(resultScr);
}

function win(){
    resultTitle.innerText = "üëë HUY·ªÄN THO·∫†I!";
    resultMsg.innerText = "Kh√¥ng th·ªÉ tin n·ªïi! B·∫°n ƒë√£ v∆∞·ª£t qua 15 c√¢u h·ªèi sinh t·ª≠! üß†üî•";
    show(resultScr);
}

function resetProgress(){
    if(confirm("X√≥a l·ªãch s·ª≠ s·∫Ω l√†m m·ªõi to√†n b·ªô kho c√¢u h·ªèi. B·∫°n ch·∫Øc ch·ª©?")){
        localStorage.removeItem(LOCK_KEY);
        locked = [];
        alert("ƒê√£ l√†m m·ªõi kho c√¢u h·ªèi!");
    }
}

function show(scr){
    [startScr, playScr, resultScr].forEach(s => s.classList.add("hidden"));
    scr.classList.remove("hidden");
}
</script>
</body>
</html>
