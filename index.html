<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ai L√† Th√°nh Nh·ªç Pro - Hosted by NCT</title>
    <style>
        :root { --gold: #f1c40f; --blue: #0984e3; --red: #d63031; --dark: #020230; --green: #2ecc71; }
        body { margin: 0; background: radial-gradient(circle, #0a3d62, #020230); font-family: 'Segoe UI', Tahoma, sans-serif; color: white; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; }
        .main-game { width: 95%; max-width: 500px; background: rgba(0, 0, 0, 0.95); padding: 25px; border: 3px solid var(--gold); border-radius: 25px; text-align: center; box-shadow: 0 0 50px rgba(241, 196, 15, 0.2); }
        .nct-host { font-style: italic; color: var(--gold); margin-bottom: 15px; min-height: 50px; display: flex; align-items: center; justify-content: center; font-size: 1rem; }
        .grid-layout { display: grid; gap: 12px; margin-top: 10px; }
        .btn-action { background: transparent; border: 2px solid var(--gold); color: white; padding: 12px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 1rem; transition: 0.3s; }
        .btn-action:hover { background: var(--gold); color: black; }
        .penalty-tag { background: var(--red); padding: 8px 15px; border-radius: 20px; font-weight: bold; display: inline-block; margin-bottom: 15px; }
        .question-box { margin: 15px 0; min-height: 100px; border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: center; }
        .option { background: rgba(255, 255, 255, 0.05); border: 1px solid var(--blue); color: white; padding: 12px; border-radius: 12px; cursor: pointer; width: 100%; margin-bottom: 8px; transition: 0.2s; position: relative; overflow: hidden; }
        .hidden { display: none; }
        #step-counter { margin-top: 15px; color: #888; font-size: 0.8rem; }
    </style>
</head>
<body>
    <div class="main-game">
        <div id="scr-lang">
            <h1 style="color: var(--gold);">üç∫ AI L√Ä TH√ÅNH NH·ªå üç∫</h1>
            <div class="nct-host">"NCT ƒë√£ s·∫µn s√†ng, c√≤n b·∫°n th√¨ sao?"</div>
            <button class="btn-action" style="width: 100%" onclick="initGame()">B·∫ÆT ƒê·∫¶U CU·ªòC CH∆†I üöÄ</button>
        </div>

        <div id="scr-mode" class="hidden">
            <div class="nct-host">"Ch·ªçn s·ªë c√¢u h·ªèi. Ng∆∞·ªùi sau s·∫Ω nh·∫≠n b·ªô c√¢u m·ªõi ho√†n to√†n!"</div>
            <div class="grid-layout">
                <button class="btn-action" onclick="startGame(6)">NH·∫∏ NH√ÄNG (6 c√¢u)</button>
                <button class="btn-action" onclick="startGame(10)">TH√ÅNH NH·∫¨U (10 c√¢u)</button>
                <button class="btn-action" onclick="startGame(15)">H·ª¶Y DI·ªÜT (15 c√¢u)</button>
            </div>
        </div>

        <div id="scr-quiz" class="hidden">
            <div id="penalty-text" class="penalty-tag"></div>
            <div class="question-box"><h2 id="q-text"></h2></div>
            <div id="options-box"></div>
            <div id="step-counter"></div>
        </div>

        <div id="scr-res" class="hidden">
            <h1 id="res-title"></h1>
            <div style="font-size: 4rem;" id="res-icon"></div>
            <p id="res-desc" style="font-weight: bold; color: var(--gold);"></p>
            <div class="nct-host" id="res-nct"></div>
            <button class="btn-action" onclick="location.reload()" style="width: 100%;">NG∆Ø·ªúI TI·∫æP THEO</button>
        </div>
    </div>

    <script>
        // Ph√¢n lo·∫°i ƒë·ªô kh√≥
        const QUESTIONS = {
            easy: [
                {id: 1, q: "C√°i g√¨ ƒëen khi s·∫°ch v√† tr·∫Øng khi b·∫©n?", o: ["Than", "B·∫£ng ƒëen", "M·ª±c", "T√≥c"], a: 1},
                {id: 2, q: "Con m√®o n√†o c·ª±c k·ª≥ s·ª£ chu·ªôt?", o: ["M√®o Tom", "Doraemon", "M√®o Oggy", "M√®o Kitty"], a: 1},
                {id: 4, q: "Th√°ng n√†o c√≥ 28 ng√†y?", o: ["Th√°ng 2", "Th√°ng Nhu·∫≠n", "T·∫•t c·∫£ c√°c th√°ng", "Th√°ng 12"], a: 2},
                {id: 5, q: "Con g√¨ c√†ng to c√†ng nh·ªè?", o: ["Con voi", "Con cua", "Con ki·∫øn", "Con r√πa"], a: 1},
                {id: 8, q: "Qu·∫ßn g√¨ r·ªông nh·∫•t?", o: ["Qu·∫ßn b√≤", "Qu·∫ßn ƒë·∫£o", "Qu·∫ßn ·ªëng loe", "Qu·∫ßn ƒë√πi"], a: 1},
                {id: 17, q: "Con chu·ªôt n√†o ƒëi b·∫±ng 2 ch√¢n?", o: ["Chu·ªôt c·ªëng", "Mickey", "Chu·ªôt nh·∫Øt", "Jerry"], a: 1},
                {id: 18, q: "V·ªãt n√†o ƒëi b·∫±ng 2 ch√¢n?", o: ["V·ªãt Donald", "V·ªãt b·∫ßu", "T·∫•t c·∫£ lo√†i v·ªãt", "V·ªãt quay"], a: 2},
                {id: 69, q: "G√† tr·ªëng c√≥ th·ªÉ ƒë·∫ª bao nhi√™u tr·ª©ng m·ªôt nƒÉm?", o: ["0", "1", "12", "365"], a: 0},
                {id: 98, q: "M·ªôt c√¢n s·∫Øt v√† m·ªôt c√¢n b√¥ng, c√°i n√†o n·∫∑ng h∆°n?", o: ["S·∫Øt", "B√¥ng", "B·∫±ng nhau", "S·∫Øt (v√¨ kh·ªëi l∆∞·ª£ng ri√™ng)"], a: 2}
            ],
            medium: [
                {id: 11, q: "H√†nh tinh n√†o g·∫ßn M·∫∑t tr·ªùi nh·∫•t?", o: ["Sao Kim", "Sao H·ªèa", "Sao Th·ªßy", "Tr√°i ƒê·∫•t"], a: 2},
                {id: 13, q: "Kim lo·∫°i n√†o l·ªèng ·ªü nhi·ªát ƒë·ªô th∆∞·ªùng?", o: ["S·∫Øt", "V√†ng", "Th·ªßy ng√¢n", "Ch√¨"], a: 2},
                {id: 21, q: "N·∫Øng ba nƒÉm t√¥i kh√¥ng b·ªè b·∫°n, m∆∞a 1 ng√†y b·∫°n b·ªè t√¥i l√† ai?", o: ["Ng∆∞·ªùi y√™u", "C√°i b√≥ng", "C√°i √°o", "ƒê√¥i d√©p"], a: 1},
                {id: 23, q: "Tr√™n nh·∫•p d∆∞·ªõi s∆∞·ªõng, d∆∞·ªõi nh·∫•p tr√™n ƒëau l√† l√†m g√¨?", o: ["ƒêi xe ƒë·∫°p", "C√¢u c√°", "ƒê√°nh ƒëu", "Ch√®o thuy·ªÅn"], a: 1},
                {id: 46, q: "NƒÉm nhu·∫≠n c√≥ bao nhi√™u ng√†y?", o: ["364", "365", "366", "367"], a: 2},
                {id: 76, q: "Tr√°i tim ng∆∞·ªùi b√¨nh th∆∞·ªùng c√≥ m·∫•y ngƒÉn?", o: ["2", "3", "4", "5"], a: 2},
                {id: 82, q: "M√†u n√†o KH√îNG c√≥ trong d·∫£i c·∫ßu v·ªìng?", o: ["T√≠m", "Ch√†m", "Tr·∫Øng", "ƒê·ªè"], a: 2},
                {id: 91, q: "Th·ª©c ƒÉn ch√≠nh c·ªßa g·∫•u tr√∫c l√† g√¨?", o: ["C√°", "Tre n·ª©a", "M·∫≠t ong", "Th·ªãt"], a: 1}
            ],
            hard: [
                {id: 12, q: "Vua n√†o ·ªü ng√¥i ng·∫Øn nh·∫•t VN (3 ng√†y)?", o: ["D·ª•c ƒê·ª©c", "Hi·ªáp H√≤a", "H√†m Nghi", "Duy T√¢n"], a: 0},
                {id: 57, q: "Qu·ªëc gia n√†o tr√™n th·∫ø gi·ªõi kh√¥ng c√≥ mu·ªói?", o: ["Iceland", "Greenland", "Th·ª•y Sƒ©", "Nh·∫≠t B·∫£n"], a: 0},
                {id: 41, q: "S·ªë 0 ƒë∆∞·ª£c ph√°t minh ƒë·∫ßu ti√™n b·ªüi qu·ªëc gia n√†o?", o: ["·∫§n ƒê·ªô", "Hy L·∫°p", "Trung Qu·ªëc", "·∫¢ R·∫≠p"], a: 0},
                {id: 61, q: "Tr√°i ƒë·∫•t t·ª± quay quanh tr·ª•c m·∫•t bao l√¢u?", o: ["23h 56ph", "24h", "24h 04ph", "25h"], a: 0},
                {id: 97, q: "B·ªë m·∫π c√≥ 6 trai, m·ªói ng∆∞·ªùi c√≥ 1 em g√°i. Nh√† c√≥ m·∫•y anh em?", o: ["13", "12", "7", "8"], a: 2}
            ]
        };

        const NCT_TRICK = {
            id: 999, 
            q: "NCT c√≥ ƒë·∫πp trai kh√¥ng?", 
            o: ["C√≥", "R·∫•t ƒë·∫πp", "Kh√¥ng", "C·ª±c ph·∫©m"], 
            a: 2, 
            isTrick: true
        };

        // T·∫°o th√™m data gi·∫£ cho ƒë·ªß kho 100 c√¢u
        for(let i=100; i<150; i++) {
            QUESTIONS.easy.push({id: i, q: `C√¢u h·ªèi d·ªÖ s·ªë ${i}?`, o: ["A","B","C","D"], a: 0});
            QUESTIONS.medium.push({id: i+100, q: `C√¢u h·ªèi v·ª´a s·ªë ${i}?`, o: ["A","B","C","D"], a: 1});
            QUESTIONS.hard.push({id: i+200, q: `C√¢u h·ªèi kh√≥ s·ªë ${i}?`, o: ["A","B","C","D"], a: 2});
        }

        let state = { limit: 0, step: 0, currentList: [], mistakes: 0 };

        function initGame() {
            document.getElementById('scr-lang').classList.add('hidden');
            document.getElementById('scr-mode').classList.remove('hidden');
        }

        function startGame(limit) {
            state.limit = limit;
            state.step = 0;
            state.mistakes = 0;

            let usedIds = JSON.parse(sessionStorage.getItem('used_v3') || '[]');
            
            const getValid = (list) => list.filter(q => !usedIds.includes(q.id)).sort(() => Math.random() - 0.5);

            let ePool = getValid(QUESTIONS.easy);
            let mPool = getValid(QUESTIONS.medium);
            let hPool = getValid(QUESTIONS.hard);

            // X√¢y d·ª±ng l·ªô tr√¨nh: 1/3 d·ªÖ, 1/3 v·ª´a, 1/3 kh√≥
            let list = [];
            let part = Math.floor(limit/3);
            
            list.push(...ePool.slice(0, part));
            list.push(...mPool.slice(0, part));
            list.push(...hPool.slice(0, limit - (part*2)));

            // Ch√®n c√¢u NCT v√†o v·ªã tr√≠ ng·∫´u nhi√™n t·ª´ 3 ƒë·∫øn 6 (index 2-5)
            let trickPos = Math.floor(Math.random() * 4) + 2;
            if(trickPos >= list.length) trickPos = list.length - 1;
            list.splice(trickPos, 0, NCT_TRICK);

            state.currentList = list.slice(0, limit);
            
            // L∆∞u v√†o session ƒë·ªÉ ng∆∞·ªùi sau kh√¥ng tr√πng
            let newUsed = [...usedIds, ...state.currentList.map(q => q.id)];
            sessionStorage.setItem('used_v3', JSON.stringify(newUsed));

            document.getElementById('scr-mode').classList.add('hidden');
            document.getElementById('scr-quiz').classList.remove('hidden');
            renderQ();
        }

        function renderQ() {
            if (state.step >= state.limit) { showResult(); return; }

            let q = state.currentList[state.step];
            document.getElementById('penalty-text').innerText = `C√ÇU ${state.step + 1} / ${state.limit}`;
            document.getElementById('q-text').innerText = q.q;
            
            const box = document.getElementById('options-box');
            box.innerHTML = '';
            
            q.o.forEach((opt, i) => {
                let btn = document.createElement('button');
                btn.className = 'option';
                btn.innerText = opt;

                // X·ª≠ l√Ω c√∫ l·ª´a NCT
                if(q.isTrick && i === 2) { 
                    btn.onmouseenter = btn.ontouchstart = () => {
                        btn.innerText = "Kh√¥ng... th·ªÉ ƒë·∫πp trai h∆°n!";
                        btn.style.background = "var(--green)";
                    };
                }

                btn.onclick = () => handleSelect(i);
                box.appendChild(btn);
            });
        }

        function handleSelect(idx) {
            let q = state.currentList[state.step];
            let options = document.querySelectorAll('.option');
            
            // ƒê·ªëi v·ªõi c√¢u NCT, ch·ªçn "Kh√¥ng" (sau khi bi·∫øn h√¨nh) v·∫´n l√† ƒë√∫ng
            let isCorrect = (idx === q.a);

            if (isCorrect) {
                options[idx].style.background = "var(--green)";
                setTimeout(() => { state.step++; renderQ(); }, 500);
            } else {
                options[idx].style.background = "var(--red)";
                state.mistakes++;
                setTimeout(() => {
                    alert("SAI R·ªíI! PH·∫†T 1 LY!");
                    state.step++;
                    renderQ();
                }, 300);
            }
        }

        function showResult() {
            document.getElementById('scr-quiz').classList.add('hidden');
            document.getElementById('scr-res').classList.remove('hidden');
            let resNct = document.getElementById('res-nct');
            
            if (state.mistakes === 0) {
                document.getElementById('res-title').innerText = "TH√ÅNH T·ª¨U";
                document.getElementById('res-icon').innerText = "üèÜ";
                resNct.innerText = "NCT: 'B·∫°n qu√° t·ªânh t√°o, t√¥i ch·ªãu thua!'";
            } else {
                document.getElementById('res-title').innerText = "TH√ÅNH NH·ªå";
                document.getElementById('res-icon').innerText = "ü§Æ";
                resNct.innerText = `NCT: 'Sai ${state.mistakes} c√¢u th√¨ u·ªëng ƒë·ªß ${state.mistakes} ly nh√©!'`;
            }
        }
    </script>
</body>
</html>
