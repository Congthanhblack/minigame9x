<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ai L√† Th√°nh Nh·ªç</title>

<style>
body{
  margin:0;
  background:#020230;
  color:#fff;
  font-family:system-ui,Segoe UI;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}
.app{
  width:95%;
  max-width:420px;
  background:#000;
  border:2px solid #f1c40f;
  border-radius:20px;
  padding:20px;
  text-align:center;
}
.hidden{display:none}
button{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #f1c40f;
  background:#000;
  color:#fff;
  font-weight:bold;
  margin-top:10px;
}
button:hover{background:#f1c40f;color:#000}
.option{margin-top:8px}
.timer{height:8px;background:#333;border-radius:4px;overflow:hidden}
.timer div{height:100%;background:#e74c3c;width:100%}
.explain{
  font-size:0.85rem;
  color:#f1c40f;
  margin-top:10px;
}
.signature{
  font-size:0.7rem;
  color:rgba(255,255,255,.45);
  margin-top:10px;
}
</style>
</head>

<body>
<div class="app">

<!-- START -->
<div id="start">
  <h2>üç∫ AI L√Ä TH√ÅNH NH·ªå üç∫</h2>

  <input id="playerName" placeholder="Nh·∫≠p t√™n‚Ä¶" style="width:100%;padding:10px;border-radius:8px">

  <select id="difficulty" style="width:100%;margin-top:10px;padding:10px">
    <option value="easy">D·ªÖ (20s)</option>
    <option value="medium">Trung b√¨nh (15s)</option>
    <option value="hard">Kh√≥ (20s)</option>
  </select>

  <button onclick="startGame()">V√ÄO CU·ªòC</button>
</div>

<!-- QUIZ -->
<div id="quiz" class="hidden">
  <div id="timerText">--</div>
  <div class="timer"><div id="bar"></div></div>
  <h3 id="question"></h3>
  <div id="options"></div>
</div>

<!-- RESULT -->
<div id="result" class="hidden">
  <h2 id="resultTitle"></h2>
  <p id="resultDesc"></p>
  <div id="explainBox" class="explain hidden"></div>
  <button onclick="location.reload()">CH∆†I TI·∫æP</button>
</div>

<div class="signature">
  ƒê√¢y l√† m·ªôt tr√≤ ch∆°i gi·∫£i tr√≠ nh·ªè do <b>NCT</b> th·ª±c hi·ªán.  
  N·∫øu b·∫°n th·∫•y th√∫ v·ªã, h√£y c·ª© ch∆°i v√† chia s·∫ª c√πng b·∫°n b√® üçª
</div>

</div>

<script>
/* ================== QUESTION BANK ================== */

let QUESTION_BANK = [];
let qid = 0;

// ====== C√ÇU M·∫™U (40) ======
const BASE_QUESTIONS = [
  {
    q:"Th√°ng n√†o c√≥ 28 ng√†y?",
    answers:["T·∫•t c·∫£ c√°c th√°ng"],
    options:["Th√°ng 2","Th√°ng ch·∫µn","T·∫•t c·∫£ c√°c th√°ng","Th√°ng l·∫ª"],
    level:0
  },
  {
    q:"S·ªë n√†o chia cho ch√≠nh n√≥ lu√¥n b·∫±ng 1?",
    answers:["M·ªçi s·ªë kh√°c 0","M·ªçi s·ªë"],
    options:["S·ªë ch·∫µn","S·ªë l·∫ª","M·ªçi s·ªë","M·ªçi s·ªë kh√°c 0"],
    level:1,
    explain:"M·ªçi s·ªë kh√°c 0 khi chia cho ch√≠nh n√≥ ƒë·ªÅu b·∫±ng 1. S·ªë 0 kh√¥ng x√°c ƒë·ªãnh."
  },
  {
    q:"ƒêi·ªÅn v√†o ch·ªó tr·ªëng: C√≥ c√¥ng m√†i ___ c√≥ ng√†y n√™n kim",
    answers:["s·∫Øt"],
    options:["ƒë√°","s·∫Øt","dao","g·ªó"],
    level:0
  },
  {
    q:"C√¢u n√†o ƒë√∫ng?",
    answers:["C√° voi l√† ƒë·ªông v·∫≠t c√≥ v√∫","C√° voi th·ªü b·∫±ng ph·ªïi"],
    options:[
      "C√° voi l√† c√°",
      "C√° voi ƒë·∫ª tr·ª©ng",
      "C√° voi l√† ƒë·ªông v·∫≠t c√≥ v√∫",
      "C√° voi th·ªü b·∫±ng ph·ªïi"
    ],
    level:2,
    explain:"C√° voi thu·ªôc l·ªõp th√∫ (ƒë·ªông v·∫≠t c√≥ v√∫), sinh con v√† th·ªü b·∫±ng ph·ªïi."
  }
];

// ====== SINH 800 C√ÇU ======
for(let i=0;i<800;i++){
  let base = BASE_QUESTIONS[i % BASE_QUESTIONS.length];
  QUESTION_BANK.push({
    id: qid++,
    q: base.q,
    answers: base.answers,
    options: shuffle([...base.options]),
    level: base.level,
    explain: base.explain || ""
  });
}

/* ================== STATE ================== */

let usedIds = JSON.parse(localStorage.getItem("USED_Q_IDS") || "[]");
let timer=null, time=0, maxTime=0;
let current=null;

/* ================== GAME ================== */

function startGame(){
  if(!playerName.value.trim()) return alert("Nh·∫≠p t√™n ƒë√£ üòà");
  start.classList.add("hidden");
  quiz.classList.remove("hidden");
  nextQuestion();
}

function getTime(){
  return difficulty.value==="medium"?15:20;
}

function nextQuestion(){
  let diff = difficulty.value;
  let pool = QUESTION_BANK.filter(q =>
    !usedIds.includes(q.id) &&
    (diff==="easy"?q.level===0:
     diff==="medium"?q.level<=1:
     q.level>=1)
  );

  if(pool.length===0){
    alert("ƒê√£ h·∫øt c√¢u h·ªèi. Kho s·∫Ω ƒë∆∞·ª£c reset!");
    usedIds=[];
    localStorage.removeItem("USED_Q_IDS");
    pool=[...QUESTION_BANK];
  }

  current = pool[Math.floor(Math.random()*pool.length)];

  // üîí KH√ìA NGAY KHI HI·ªÇN TH·ªä
  usedIds.push(current.id);
  localStorage.setItem("USED_Q_IDS",JSON.stringify(usedIds));

  question.innerText=current.q;
  options.innerHTML="";

  current.options.forEach(v=>{
    let b=document.createElement("button");
    b.className="option";
    b.innerText=v;
    b.onclick=()=>answer(v);
    options.appendChild(b);
  });

  startTimer();
}

function startTimer(){
  clearInterval(timer);
  maxTime=getTime();
  time=maxTime;
  timer=setInterval(()=>{
    time-=0.1;
    timerText.innerText=Math.ceil(time)+"s";
    bar.style.width=(time/maxTime*100)+"%";
    if(time<=0) lose("H·∫øt gi·ªù");
  },100);
}

function answer(v){
  clearInterval(timer);
  if(current.answers.includes(v)){
    nextQuestion();
  }else{
    lose("Sai r·ªìi");
  }
}

function lose(reason){
  quiz.classList.add("hidden");
  result.classList.remove("hidden");
  resultTitle.innerText="üíÄ THUA CU·ªòC";
  resultDesc.innerText=reason + ". U·ªëng th√¥i üç∫";

  if(current.explain){
    explainBox.classList.remove("hidden");
    explainBox.innerText="üí° Gi·∫£i th√≠ch: " + current.explain;
  }
}

/* ================== UTIL ================== */
function shuffle(a){return a.sort(()=>Math.random()-0.5);}
</script>
</body>
</html>
