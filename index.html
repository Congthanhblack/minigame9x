<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ai L√† Th√°nh Nh·ªç Pro - Ultra Countdown Edition</title>
    <style>
        :root { --gold: #f1c40f; --blue: #0984e3; --red: #d63031; --dark: #020230; --green: #2ecc71; }
        body { margin: 0; background: radial-gradient(circle, #0a3d62, #020230); font-family: 'Segoe UI', Tahoma, sans-serif; color: white; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; touch-action: manipulation; }
        .main-game { width: 95%; max-width: 500px; background: rgba(0, 0, 0, 0.95); padding: 25px; border: 3px solid var(--gold); border-radius: 25px; text-align: center; box-shadow: 0 0 50px rgba(241, 196, 15, 0.2); position: relative; }
        .nct-host { font-style: italic; color: var(--gold); margin-bottom: 10px; min-height: 60px; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; font-weight: bold; }
        
        /* ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c */
        .timer-container { width: 100%; height: 10px; background: #333; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        #timer-bar { width: 100%; height: 100%; background: linear-gradient(90deg, var(--green), var(--red)); transition: width 0.1s linear; }
        #timer-text { font-size: 1.5rem; font-weight: bold; color: var(--red); margin-bottom: 10px; }

        .btn-action { background: transparent; border: 2px solid var(--gold); color: white; padding: 12px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 1rem; transition: 0.3s; width: 100%; margin-top: 10px; }
        .btn-action:hover { background: var(--gold); color: black; }
        .penalty-tag { background: var(--red); padding: 8px 15px; border-radius: 20px; font-weight: bold; display: inline-block; margin-bottom: 15px; }
        .question-box { margin: 15px 0; min-height: 80px; border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: center; }
        .options-container { position: relative; min-height: 300px; margin-top: 10px; }
        .option { background: rgba(255, 255, 255, 0.05); border: 1px solid var(--blue); color: white; padding: 12px; border-radius: 12px; cursor: pointer; width: 100%; margin-bottom: 8px; transition: transform 0.1s ease-out, background 0.2s; font-size: 1rem; display: block; box-sizing: border-box; }
        .option.evasive { position: absolute; width: 100%; z-index: 10; }
        .hidden { display: none; }
        .shake { animation: shake 0.3s; }
        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-8px); } 50% { transform: translateX(8px); } 75% { transform: translateX(-8px); } 100% { transform: translateX(0); } }
        #troll-msg { color: #ff7675; font-weight: bold; margin: 15px 0; font-size: 1.1rem; line-height: 1.4; }
    </style>
</head>
<body>
    <div class="main-game" id="game-container">
        <div id="scr-start">
            <h1 style="color: var(--gold); margin-bottom: 0;">üç∫ AI L√Ä TH√ÅNH NH·ªå üç∫</h1>
            <p style="color: #888; margin-top: 5px;">H·∫øt 15 gi√¢y l√† PH·∫†T!</p>
            <div class="nct-host">"15 gi√¢y cho m·ªói c√¢u. Qu√° ch·∫≠m l√† u·ªëng!"</div>
            <button class="btn-action" onclick="startGame()">V√ÄO CU·ªòC üöÄ</button>
        </div>

        <div id="scr-quiz" class="hidden">
            <div id="timer-text">15s</div>
            <div class="timer-container"><div id="timer-bar"></div></div>
            <div id="penalty-text" class="penalty-tag"></div>
            <div class="nct-host" id="quiz-msg">"Nhanh tay l√™n n√†o!"</div>
            <div class="question-box"><h2 id="q-text"></h2></div>
            <div id="options-box" class="options-container"></div>
        </div>

        <div id="scr-res" class="hidden">
            <h1 id="res-title"></h1>
            <div style="font-size: 5rem;" id="res-icon"></div>
            <p id="res-desc" style="font-weight: bold; color: var(--gold);"></p>
            <div id="troll-msg"></div>
            <div class="nct-host" id="res-nct"></div>
            <button class="btn-action" onclick="location.reload()">B·∫ÆT ƒê·∫¶U L·∫†I üîÑ</button>
        </div>
    </div>

    <script>
        const WRONG_MSGS = ["ü§° Ch·∫≠m nh∆∞ r√πa!", "ü§® Suy nghƒ© l√¢u th·∫ø?", "üç∫ R√≥t r∆∞·ª£u ƒëi, h·∫øt gi·ªù r·ªìi!", "üåö G√† m·ªù qu√° b·∫°n ∆°i!"];
        const CORRECT_MSGS = ["üî• Qu√° nhanh qu√° nguy hi·ªÉm!", "‚ö° Ph·∫£n x·∫° tuy·ªát v·ªùi!", "üíé C·ª© th·∫ø m√† ph√°t huy!", "üëè ƒê·ªânh c·ªßa ch√≥p!"];

        const ALL_QUESTIONS = [];
        const RAW_DATA = [
            {q: "N√∫i n√†o b·ªã ch·∫∑t ra t·ª´ng kh√∫c?", o: ["Th√°i S∆°n", "Ng≈© H√†nh", "N√∫i ƒê√®o", "Fansipan"], a: 2},
            {q: "Th√°ng n√†o c√≥ 28 ng√†y?", o: ["Th√°ng 2", "Th√°ng Nhu·∫≠n", "T·∫•t c·∫£ c√°c th√°ng", "Th√°ng 12"], a: 2},
            {q: "C√°i g√¨ ƒëen khi s·∫°ch, tr·∫Øng khi b·∫©n?", o: ["Than", "B·∫£ng ƒëen", "M·ª±c", "T√≥c"], a: 1},
            {q: "B·ªánh g√¨ b√°c sƒ© b√≥ tay?", o: ["G√£y tay", "ƒêau ƒë·∫ßu", "S·ªï m≈©i", "Huy·∫øt √°p"], a: 0},
            {q: "L·ªãch n√†o d√†i nh·∫•t?", o: ["L·ªãch s·ª≠", "V·∫°n ni√™n", "L·ªãch g·ªó", "L·ªãch √¢m"], a: 0},
            {q: "Qu·∫ßn g√¨ r·ªông nh·∫•t?", o: ["Qu·∫ßn b√≤", "Qu·∫ßn ƒë·∫£o", "Qu·∫ßn ƒë√πi", "Qu·∫ßn th·ª•ng"], a: 1},
            {q: "Con g√¨ c√†ng to c√†ng nh·ªè?", o: ["Con voi", "Con cua", "Con ki·∫øn", "Con r√πa"], a: 1}
        ];

        for(let i=0; i<160; i++) {
            let t = RAW_DATA[i % RAW_DATA.length];
            ALL_QUESTIONS.push({ id: i, q: t.q, o: [...t.o], a: t.a });
        }

        const NCT_TRICK = { 
            id: 999, 
            q: "NCT c√≥ ƒë·∫πp trai kh√¥ng?", 
            o: ["Kh√¥ng ƒë·∫πp", "Kh√¥ng bi·∫øt", "ƒê·∫πp trai nh·∫•t v·ªãnh b·∫Øc b·ªô", "X·∫•u trai"], 
            a: 2, 
            isTrick: true 
        };

        let state = { step: 0, currentList: [], limit: 15, timeLeft: 15, timer: null };

        function startGame() {
            let usedIds = JSON.parse(sessionStorage.getItem('nct_v7_used') || '[]');
            let pool = ALL_QUESTIONS.filter(q => !usedIds.includes(q.id)).sort(() => Math.random() - 0.5);
            if (pool.length < 15) { usedIds = []; pool = ALL_QUESTIONS.sort(() => Math.random() - 0.5); }

            state.currentList = pool.slice(0, 14);
            state.currentList.splice(Math.floor(Math.random() * 4) + 2, 0, NCT_TRICK);
            sessionStorage.setItem('nct_v7_used', JSON.stringify([...usedIds, ...state.currentList.map(q => q.id)]));
            
            document.getElementById('scr-start').classList.add('hidden');
            document.getElementById('scr-quiz').classList.remove('hidden');
            renderQ();
        }

        function startTimer() {
            clearInterval(state.timer);
            state.timeLeft = 15;
            const bar = document.getElementById('timer-bar');
            const text = document.getElementById('timer-text');
            
            state.timer = setInterval(() => {
                state.timeLeft -= 0.1;
                text.innerText = Math.ceil(state.timeLeft) + "s";
                bar.style.width = (state.timeLeft / 15 * 100) + "%";

                if (state.timeLeft <= 0) {
                    clearInterval(state.timer);
                    showResult(false, "H·∫øt gi·ªù r·ªìi, ch·∫≠m nh∆∞ r√πa!");
                }
            }, 100);
        }

        function renderQ() {
            if (state.step >= state.limit) { showResult(true); return; }
            startTimer();
            let q = state.currentList[state.step];
            document.getElementById('penalty-text').innerText = `C√ÇU ${state.step + 1} / ${state.limit}`;
            document.getElementById('q-text').innerText = q.q;
            
            const box = document.getElementById('options-box');
            box.innerHTML = '';
            
            q.o.forEach((opt, i) => {
                let btn = document.createElement('button');
                btn.className = 'option';
                btn.innerText = opt;
                
                if (q.isTrick) {
                    if (i !== q.a) {
                        btn.classList.add('evasive');
                        btn.style.top = (i * 65) + "px";
                        btn.onmouseover = btn.ontouchstart = (e) => { e.preventDefault(); moveButton(btn); };
                    } else {
                        btn.style.marginTop = "260px";
                    }
                }

                btn.onclick = () => {
                    clearInterval(state.timer);
                    if (i === q.a) {
                        btn.style.background = "var(--green)";
                        document.getElementById('quiz-msg').innerText = "NCT: " + CORRECT_MSGS[Math.floor(Math.random()*CORRECT_MSGS.length)];
                        setTimeout(() => { state.step++; renderQ(); }, 600);
                    } else {
                        showResult(false);
                    }
                };
                box.appendChild(btn);
            });
        }

        function moveButton(btn) {
            let randomX = (Math.random() - 0.5) * 300;
            let randomY = (Math.random() - 0.5) * 100;
            btn.style.transform = `translate(${randomX}px, ${randomY}px)`;
        }

        function showResult(isWin, customMsg) {
            clearInterval(state.timer);
            document.getElementById('scr-quiz').classList.add('hidden');
            document.getElementById('scr-res').classList.remove('hidden');
            const troll = document.getElementById('troll-msg');
            const container = document.getElementById('game-container');
            
            if (isWin) {
                document.getElementById('res-title').innerText = "TH·∫ÆNG CU·ªòC!";
                document.getElementById('res-icon').innerText = "ü§¥";
                document.getElementById('res-desc').innerText = "Qu√° b·∫£n lƒ©nh!";
            } else {
                container.classList.add('shake');
                document.getElementById('res-title').innerText = "THUA CU·ªòC!";
                document.getElementById('res-icon').innerText = "ü§Æ";
                document.getElementById('res-desc').innerText = customMsg || `D·ª´ng b∆∞·ªõc ·ªü c√¢u ${state.step + 1}`;
                if (state.step < 7) {
                    troll.innerText = "√öi d·ªùi b·∫°n c√≤n kh√¥ng th√¥ng minh h∆°n h·ªçc sinh l·ªõp 5 hihi.....";
                }
                document.getElementById('res-nct').innerText = "NCT: " + WRONG_MSGS[Math.floor(Math.random()*WRONG_MSGS.length)];
            }
        }
    </script>
</body>
</html>
