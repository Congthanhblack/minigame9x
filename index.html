<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ai L√† Th√°nh Nh·ªç</title>

<style>
body{
  margin:0;
  background:#020230;
  color:#fff;
  font-family:system-ui,Segoe UI;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}
.app{
  width:95%;
  max-width:420px;
  background:#000;
  border:2px solid #f1c40f;
  border-radius:20px;
  padding:20px;
  text-align:center;
}
.hidden{display:none}
button{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #f1c40f;
  background:#000;
  color:#fff;
  font-weight:bold;
  margin-top:10px;
}
button:hover{background:#f1c40f;color:#000}
.option{margin-top:8px}
.timer{height:8px;background:#333;border-radius:4px;overflow:hidden}
.timer div{height:100%;background:#e74c3c;width:100%}
.signature{
  font-size:0.7rem;
  color:rgba(255,255,255,.45);
  margin-top:10px;
}
.history{
  font-size:0.8rem;
  text-align:left;
  margin-top:10px;
}
</style>
</head>

<body>
<div class="app">

<!-- START -->
<div id="start">
  <h2>üç∫ AI L√Ä TH√ÅNH NH·ªå üç∫</h2>

  <input id="playerName" placeholder="Nh·∫≠p t√™n‚Ä¶" style="width:100%;padding:10px;border-radius:8px">

  <select id="difficulty" style="width:100%;margin-top:10px;padding:10px">
    <option value="easy">D·ªÖ</option>
    <option value="medium">Trung b√¨nh</option>
    <option value="hard">Kh√≥</option>
  </select>

  <button onclick="startGame()">V√ÄO CU·ªòC</button>
</div>

<!-- QUIZ -->
<div id="quiz" class="hidden">
  <div id="timerText">5s</div>
  <div class="timer"><div id="bar"></div></div>
  <h3 id="question"></h3>
  <div id="options"></div>
</div>

<!-- RESULT -->
<div id="result" class="hidden">
  <h2 id="resultTitle"></h2>
  <p id="resultDesc"></p>
  <div id="historyBox" class="history hidden"></div>
  <button onclick="location.reload()">CH∆†I TI·∫æP</button>
</div>

<div class="signature">
  ƒê√¢y l√† m·ªôt tr√≤ ch∆°i gi·∫£i tr√≠ nh·ªè do <b>NCT</b> th·ª±c hi·ªán.  
  N·∫øu b·∫°n th·∫•y th√∫ v·ªã, h√£y c·ª© ch∆°i v√† chia s·∫ª c√πng b·∫°n b√® üçª
</div>

</div>

<script>
/* ====== DATA ====== */

// t√™n n·ªØ
const FEMALE_NAMES=["lan","th·ªßy","hoa","h√≤a","chinh","mai","linh","ng·ªçc","vy","trang"];
const FEMALE_MSG=[
  "üò≥ Wow, t√™n nghe d·ªãu d√†ng gh√™!",
  "üå∏ C√≥ g√°i v√†o b√†n k√¨a!",
  "ü•∞ T√™n xinh v·∫≠y m√† thua l√† kh√¥ng ƒë∆∞·ª£c ƒë√¢u nha!",
  "üíÉ B√†n n√†y c√≥ m√πi may m·∫Øn r·ªìi!"
];

// kho c√¢u h·ªèi >200 (r√∫t g·ªçn hi·ªÉn th·ªã, logic sinh)
const QUESTIONS=[];
const BASE=[
  ["Th√°ng n√†o c√≥ 28 ng√†y?","T·∫•t c·∫£"],
  ["1+1√ó0=?","1"],
  ["C√°i g√¨ c√†ng to c√†ng nh·ªè?","Con cua"],
  ["Kh√¥ng ai mua m√† ai c≈©ng d√πng?","Quan t√†i"],
  ["ƒêi·ªÅn: C√≥ c√¥ng m√†i ___ c√≥ ng√†y n√™n kim","s·∫Øt"]
];
for(let i=0;i<250;i++){
  let b=BASE[i%BASE.length];
  QUESTIONS.push({q:b[0],a:b[1],level:i%3});
}

// random ng∆∞·ªùi u·ªëng
function randomDrinker(name){
  const names=JSON.parse(localStorage.getItem("players")||"[]");
  names.push(name);
  localStorage.setItem("players",JSON.stringify(names));
  return names[Math.floor(Math.random()*names.length)];
}

/* ====== STATE ====== */
let used=JSON.parse(localStorage.getItem("usedQ")||"[]");
let history=JSON.parse(localStorage.getItem("history")||"[]");
let timer, time=5, current;

/* ====== GAME ====== */
function startGame(){
  const name=playerName.value.trim();
  if(!name) return alert("Nh·∫≠p t√™n ƒë√£ üòà");

  if(FEMALE_NAMES.includes(name.toLowerCase())){
    alert(FEMALE_MSG[Math.floor(Math.random()*FEMALE_MSG.length)]);
  }

  window.player=name;
  start.classList.add("hidden");
  quiz.classList.remove("hidden");
  nextQ();
}

function nextQ(){
  const diff=difficulty.value;
  let pool=QUESTIONS.filter(q=>!used.includes(q.q));
  pool=pool.filter(q=>
    diff==="easy"?q.level===0:
    diff==="medium"?q.level<=1:q.level>=1
  );
  current=pool[Math.floor(Math.random()*pool.length)];
  question.innerText=current.q;

  options.innerHTML="";
  [current.a,"Sai","Kh√¥ng bi·∫øt","ƒêo√°n"].sort(()=>Math.random()-0.5)
  .forEach(o=>{
    let b=document.createElement("button");
    b.className="option";
    b.innerText=o;
    b.onclick=()=>answer(o);
    options.appendChild(b);
  });

  startTimer();
}

function startTimer(){
  clearInterval(timer);
  time=5;
  timer=setInterval(()=>{
    time-=0.1;
    timerText.innerText=Math.ceil(time)+"s";
    bar.style.width=(time/5*100)+"%";
    if(time<=0) lose("H·∫øt gi·ªù");
  },100);
}

function answer(v){
  clearInterval(timer);
  if(v===current.a){
    used.push(current.q);
    localStorage.setItem("usedQ",JSON.stringify(used));
    nextQ();
  }else{
    lose("Sai r·ªìi");
  }
}

function lose(msg){
  quiz.classList.add("hidden");
  result.classList.remove("hidden");

  const drinker=randomDrinker(player);
  resultTitle.innerText="üíÄ THUA CU·ªòC";
  resultDesc.innerText=`${msg}. ${drinker} u·ªëng!`;

  history.push(player);
  localStorage.setItem("history",JSON.stringify(history));

  if(history.length>=10){
    historyBox.classList.remove("hidden");
    historyBox.innerHTML="<b>L·ªãch s·ª≠ thua:</b><br>"+history.join(", ");
  }
}
</script>
</body>
</html>
