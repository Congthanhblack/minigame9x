const gameData = {
    modes: {
        easy: { vi: "Dá»„", zh: "ç®€å•", base: 1 },
        medium: { vi: "TRUNG BÃŒNH", zh: "ä¸­ç­‰", base: 2 },
        hard: { vi: "KHÃ“", zh: "å›°éš¾", base: 5 }
    },
    questions: {
        vi: [
            { q: "Con mÃ¨o nÃ o cá»±c ká»³ sá»£ chuá»™t?", q2: "å“ªåªçŒ«éå¸¸æ€•è€é¼ ï¼Ÿ", options: ["MÃ¨o mÃ¡y Doraemon", "MÃ¨o Tom", "MÃ¨o Oggy", "MÃ¨o Kitty"], a: 0 },
            { q: "Quáº£ gÃ¬ bá» háº¡t thÃ¬ Äƒn Ä‘Æ°á»£c, bá» vá» thÃ¬ khÃ´ng?", q2: "ä»€ä¹ˆæ°´æœå»ç±½èƒ½åƒï¼Œå»çš®ä¸èƒ½åƒï¼Ÿ", options: ["Quáº£ dÆ°a háº¥u", "Quáº£ ngÃ´ (báº¯p)", "Quáº£ láº¡c (Ä‘áº­u phá»™ng)", "Quáº£ trá»©ng"], a: 1 },
            { q: "SÆ¡n TÃ¹ng M-TP cÃ³ biá»‡t danh lÃ  gÃ¬?", q2: "æ­Œæ‰‹ SÆ¡n TÃ¹ng M-TP çš„æ˜µç§°æ˜¯ä»€ä¹ˆï¼Ÿ", options: ["Sáº¿p", "TÃ¹ng NÃºi", "Sky", "Cáº£ 3 Ä‘á»u Ä‘Ãºng"], a: 3 },
            { q: "ThÃ¡ng nÃ o trong nÄƒm cÃ³ 28 ngÃ y?", q2: "ä¸€å¹´ä¸­å“ªä¸ªæœˆæœ‰28å¤©ï¼Ÿ", options: ["ThÃ¡ng 2", "ThÃ¡ng Cháº¡p", "ThÃ¡ng nÃ o cÅ©ng cÃ³", "ThÃ¡ng nhuáº­n"], a: 2 },
            { q: "BÃ¡nh chÆ°ng hÃ¬nh vuÃ´ng tÆ°á»£ng trÆ°ng cho gÃ¬?", q2: "æ–¹å½¢ç²½å­è±¡å¾ç€ä»€ä¹ˆï¼Ÿ", options: ["Äáº¥t", "Trá»i", "Sá»± giÃ u sang", "Gia Ä‘Ã¬nh"], a: 0 },
            { q: "Trong 12 con giÃ¡p Viá»‡t Nam, con nÃ o khÃ¡c vá»›i Trung Quá»‘c?", q2: "è¶Šå—åäºŒç”Ÿè‚–ä¸­ï¼Œå“ªåªä¸ä¸­å›½ä¸åŒï¼Ÿ", options: ["Con Thá»/MÃ¨o", "Con TrÃ¢u/BÃ²", "Con Há»•", "Con DÃª"], a: 0 },
            { q: "Tá»‰nh nÃ o cá»§a VN cÃ³ tÃªn báº¯t Ä‘áº§u báº±ng chá»¯ 'T' nhiá»u nháº¥t?", q2: "è¶Šå—å“ªä¸ªå­—æ¯å¼€å¤´çš„çœä»½æœ€å¤šï¼Ÿ", options: ["Chá»¯ H", "Chá»¯ T", "Chá»¯ Q", "Chá»¯ N"], a: 1 },
            { q: "Náº¯ng ba nÄƒm tÃ´i khÃ´ng bá» báº¡n, mÆ°a má»™t ngÃ y báº¡n bá» tÃ´i lÃ  cÃ¡i gÃ¬?", q2: "æ™´å¤©ä¸ç¦»å¼€ï¼Œé›¨å¤©å°±ç¦»å¼€ï¼Œæ˜¯ä»€ä¹ˆï¼Ÿ", options: ["CÃ¡i nÃ³n", "ÄÃ´i dÃ©p", "CÃ¡i bÃ³ng", "NgÆ°á»i yÃªu cÅ©"], a: 2 },
            { q: "Linh váº­t cá»§a SEA Games 31 tá»• chá»©c táº¡i VN lÃ  con gÃ¬?", q2: "åœ¨è¶Šå—ä¸¾è¡Œçš„ç¬¬31å±Šä¸œå—äºšè¿åŠ¨ä¼šå‰ç¥¥ç‰©æ˜¯ä»€ä¹ˆï¼Ÿ", options: ["TrÃ¢u vÃ ng", "Sao la", "Chim háº¡c", "Rá»“ng"], a: 1 },
            { q: "Nghá»‡ thuáº­t cáº£i lÆ°Æ¡ng báº¯t nguá»“n tá»« miá»n nÃ o?", q2: "æ”¹è‰¯æˆï¼ˆCáº£i LÆ°Æ¡ngï¼‰èµ·æºäºå“ªé‡Œï¼Ÿ", options: ["Miá»n Báº¯c", "Miá»n Trung", "Miá»n Nam", "TÃ¢y NguyÃªn"], a: 2 }
        ],
        zh: [
            { q: "â€˜ä¸‰ä¸ªè‡­çš®åŒ â€™ ä¸‹ä¸€å¥æ˜¯ï¼Ÿ", q2: "CÃ¢u tiáº¿p theo cá»§a 'Ba thá»£ da' lÃ ?", options: ["èµ›è¿‡è¯¸è‘›äº®", "è¿˜æ˜¯è‡­çš®åŒ ", "å„å¸ˆå„æ³•", "ä¸åˆ†ä¸Šä¸‹"], a: 0 },
            { q: "â€˜å›§â€™ è¿™ä¸ªå­—é€šå¸¸è¡¨è¾¾ä»€ä¹ˆæ„æ€ï¼Ÿ", q2: "Chá»¯ 'JiÇ’ng' thÆ°á»ng biá»ƒu Ä‘áº¡t Ã½ nghÄ©a gÃ¬?", options: ["å¼€å¿ƒ", "å°´å°¬/æ— å¥ˆ", "ç”Ÿæ°”", "éå¸¸æœ‰é’±"], a: 1 },
            { q: "ç«é”…ä¸­çš„ 'æ¯›è‚š' æ˜¯ç‰›çš„å“ªä¸ªéƒ¨ä½ï¼Ÿ", q2: "'SÃ¡ch bÃ²' trong láº©u lÃ  bá»™ pháº­n nÃ o cá»§a con bÃ²?", options: ["èƒƒ", "è‚", "è‚ ", "è‚º"], a: 0 },
            { q: "å“ªç§æ°´æœè¢«ç§°ä¸º 'æœä¸­ä¹‹ç‹'ï¼Ÿ", q2: "Loáº¡i quáº£ nÃ o Ä‘Æ°á»£c gá»i lÃ  'Vua cá»§a cÃ¡c loáº¡i trÃ¡i cÃ¢y'?", options: ["è¥¿ç“œ", "æ¦´è²", "è‹¹æœ", "é¦™è•‰"], a: 1 },
            { q: "ä¸­å›½è¢«ç§°ä¸º 'ç“·å™¨ä¹‹å›½'ï¼Œç“·å™¨çš„è‹±æ–‡æ˜¯ï¼Ÿ", q2: "Trung Quá»‘c lÃ  Ä‘áº¥t nÆ°á»›c gá»‘m sá»©, tá»« tiáº¿ng Anh cá»§a sá»© lÃ ?", options: ["Japan", "China", "Vietnam", "India"], a: 1 },
            { q: "è¥¿æ¸¸è®°ä¸­ï¼Œè°æƒ³åƒå”åƒ§è‚‰ï¼Ÿ", q2: "Trong TÃ¢y Du KÃ½, ai muá»‘n Äƒn thá»‹t ÄÆ°á»ng TÄƒng?", options: ["å­™æ‚Ÿç©º", "ç™½éª¨ç²¾", "çŒªå…«æˆ’", "æ²™å’Œå°š"], a: 1 },
            { q: "ä¸­å›½çš„ 'å›½çƒ' æ˜¯ä»€ä¹ˆï¼Ÿ", q2: "MÃ´n thá»ƒ thao 'Quá»‘c báº£o' cá»§a Trung Quá»‘c lÃ  gÃ¬?", options: ["è¶³çƒ", "ç¯®çƒ", "ä¹’ä¹“çƒ", "ç¾½æ¯›çƒ"], a: 2 },
            { q: "â€˜å…ƒå®µèŠ‚â€™ ä¸ºä»€ä¹ˆè¦åƒæ±¤åœ†ï¼Ÿ", q2: "Táº¡i sao Táº¿t NguyÃªn TiÃªu láº¡i Äƒn thang viÃªn?", options: ["å›¢å›¢åœ†åœ†", "å¹´å¹´æœ‰ä½™", "æ‹›è´¢è¿›å®", "æ­¥æ­¥é«˜å‡"], a: 0 },
            { q: "ä»¥ä¸‹å“ªä¸ªä¸æ˜¯ä¸­å›½çš„ç›´è¾–å¸‚ï¼Ÿ", q2: "ThÃ nh phá»‘ nÃ o khÃ´ng pháº£i thÃ nh phá»‘ trá»±c thuá»™c trung Æ°Æ¡ng?", options: ["åŒ—äº¬", "ä¸Šæµ·", "æ·±åœ³", "é‡åº†"], a: 2 },
            { q: "å¤ä»£è¯—äººçš„ 'è¯—ä»™' æŒ‡çš„æ˜¯è°ï¼Ÿ", q2: "Trong cÃ¡c thi sÄ© cá»• Ä‘áº¡i, 'Thi TiÃªn' chá»‰ ai?", options: ["æœç”«", "æç™½", "ç™½å±…æ˜“", "ç‹ç»´"], a: 1 }
        ]
    }
};

let config = { lang: 'vi', mode: 'easy', step: 0, currentQuestions: [] };

// HÃ m xÃ¡o trá»™n máº£ng Ä‘á»ƒ cÃ¢u há»i khÃ´ng bá»‹ láº·p láº¡i thá»© tá»±
function shuffle(array) {
    return array.sort(() => Math.random() - 0.5);
}

function initGame(lang) {
    config.lang = lang;
    config.step = 0;
    // Láº¥y bá»™ cÃ¢u há»i theo ngÃ´n ngá»¯ vÃ  xÃ¡o trá»™n
    config.currentQuestions = shuffle([...gameData.questions[lang]]);
    
    document.getElementById('language-screen').classList.add('hidden');
    document.getElementById('mode-screen').classList.remove('hidden');
    document.getElementById('mode-title').innerHTML = lang === 'vi' ? "CHá»ŒN Äá»˜ KHÃ“ <br><small>é€‰æ‹©éš¾åº¦</small>" : "é€‰æ‹©éš¾åº¦ <br><small>CHá»ŒN Äá»˜ KHÃ“</small>";
}

function startQuiz(mode) {
    config.mode = mode;
    document.getElementById('mode-screen').classList.add('hidden');
    document.getElementById('quiz-screen').classList.remove('hidden');
    showQuestion();
}

function showQuestion() {
    const q = config.currentQuestions[config.step];
    const penalty = gameData.modes[config.mode].base + config.step;
    
    document.getElementById('step-counter').innerText = `CÃ¢u ${config.step + 1}/${config.currentQuestions.length}`;
    document.getElementById('penalty-text').innerText = config.lang === 'vi' ? `PHáº T: ${penalty} CHÃ‰N / æƒ©ç½š: ${penalty} æ¯` : `æƒ©ç½š: ${penalty} æ¯ / PHáº T: ${penalty} CHÃ‰N`;
    document.getElementById('question-text').innerHTML = `${q.q}<br><small>${q.q2}</small>`;
    
    const btns = document.querySelectorAll('.option');
    q.options.forEach((opt, i) => {
        btns[i].innerText = opt;
        btns[i].style.display = "block"; // Reset hiá»ƒn thá»‹
    });
}

function selectAnswer(i) {
    const correctAnswer = config.currentQuestions[config.step].a;
    if (i === correctAnswer) {
        if (config.step >= config.currentQuestions.length - 1) {
            showEnd(true);
        } else {
            config.step++;
            showQuestion();
        }
    } else {
        showEnd(false);
    }
}

function showEnd(win) {
    document.getElementById('quiz-screen').classList.add('hidden');
    document.getElementById('result-screen').classList.remove('hidden');
    const p = gameData.modes[config.mode].base + config.step;
    
    if (win) {
        document.getElementById('result-title').innerHTML = "ğŸ† CHIáº¾N THáº®NG / èƒœåˆ©";
        document.getElementById('result-desc').innerHTML = "Báº N LÃ€ THÃNH Tá»¬U!<br>Má»ŒI NGÆ¯á»œI PHáº¢I Uá»NG CHÃšC Má»ªNG Báº N!";
    } else {
        document.getElementById('result-title').innerHTML = "ğŸ’€ PHáº T / æƒ©ç½š";
        document.getElementById('result-desc').innerHTML = `SAI Rá»’I! Uá»NG ${p} CHÃ‰N!<br>è¯·å– ${p} æ¯é…’ï¼`;
    }
}

function resetGame() {
    location.reload();
}
